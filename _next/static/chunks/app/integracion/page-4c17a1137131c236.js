(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[36],{5531:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var a=r(2265);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),n=e=>{let t=o(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:l,className:o="",children:n,iconNode:c,...d},u)=>(0,a.createElement)("svg",{ref:u,...s,width:t,height:t,stroke:e,strokeWidth:l?24*Number(r)/Number(t):r,className:i("lucide",o),...d},[...c.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(n)?n:[n]])),d=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...o},s)=>(0,a.createElement)(c,{ref:s,iconNode:t,className:i(`lucide-${l(n(e))}`,`lucide-${e}`,r),...o}));return r.displayName=n(e),r}},4455:function(e,t,r){Promise.resolve().then(r.bind(r,7176))},7176:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=r(7437),l=r(2265),o=r(3740),n=r(5531);let i=(0,n.Z)("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),s=(0,n.Z)("file-spreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),c=(0,n.Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);function d(){let[e,t]=(0,l.useState)(null),[r,n]=(0,l.useState)(!1),d=e=>{if(!e)return"";let t=e.toUpperCase().trim();return["F-","FAC-","FACTURA-","FRA-","FC-","F/","FAC/","FNAA"].forEach(e=>{t.startsWith(e)&&(t=t.substring(e.length))}),t=t.replace(/[^A-Z0-9]/g,"")},u=async()=>{if(!e){alert("Por favor selecciona un archivo Excel");return}n(!0);try{let t=new FileReader,r=async e=>{let t;let r=new o.Workbook;await r.xlsx.load(e);let a=r.getWorksheet(1);if(!a)throw Error("No se pudo encontrar la hoja de c\xe1lculo");let l=0,n=0,i=r.addWorksheet("Procesado");a.eachRow((e,t)=>{let r=i.getRow(t);e.eachCell((e,t)=>{let a=r.getCell(t);a.value=e.value,a.style={...e.style}}),r.commit()});let s=6;for(;s<a.rowCount;){for(t=s;t<=a.rowCount;){let e=i.getRow(t).getCell(5),r=e.text.trim().toUpperCase();if(r.includes("TOTAL"))break;t++}let e=new Map;for(let r=s;r<t;r++){let t=i.getRow(r),a=t.getCell(5).text.trim(),l=t.getCell(6).text.trim(),o=l?parseFloat(l.replace(/,/g,"")):0;if(a&&!isNaN(o)&&o>0){let t=d(a);e.has(t)||e.set(t,[]),e.get(t).push({rowNumber:r,monto:o,referenciaOriginal:a})}}let r=new Set;for(let a=s;a<t;a++){if(r.has(a))continue;let t=i.getRow(a),o=t.getCell(5).text.trim(),s=t.getCell(7).text.trim(),c=s?parseFloat(s.replace(/,/g,"")):0;if(o&&!isNaN(c)&&c>0){let s=d(o),u=e.get(s)||[],m=u.find(e=>!r.has(e.rowNumber)&&.01>Math.abs(e.monto-c));if(m){let e={type:"pattern",pattern:"solid",fgColor:{argb:"FF90EE90"}},o=i.getRow(m.rowNumber);o.getCell(5).fill=e,o.getCell(6).fill=e,o.commit(),t.getCell(5).fill=e,t.getCell(7).fill=e,t.commit(),r.add(m.rowNumber),r.add(a),l++}else if(u.length>0){let e={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}};u.forEach(t=>{if(!r.has(t.rowNumber)){let r=i.getRow(t.rowNumber);r.getCell(5).fill=e,r.getCell(6).fill=e,r.commit()}}),t.getCell(5).fill=e,t.getCell(7).fill=e,t.commit(),n++}}}s=t+1}r.removeWorksheet(a.id),i.name="Cuenta Integrada";let c=await r.xlsx.writeBuffer(),u=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=window.URL.createObjectURL(u),f=document.createElement("a");f.href=m,f.download="cuenta_integrada.xlsx",f.click(),window.URL.revokeObjectURL(m),alert("Proceso completado.\nCoincidencias exactas: ".concat(l,"\nCoincidencias parciales: ").concat(n))};await new Promise((a,l)=>{t.onload=async e=>{try{var t;(null===(t=e.target)||void 0===t?void 0:t.result)&&(await r(e.target.result),a(null))}catch(e){l(e)}},t.onerror=()=>l(Error("Error al leer el archivo")),t.readAsArrayBuffer(e)})}catch(e){console.error("Error:",e),alert("Error al procesar el archivo: "+e.message)}finally{n(!1)}};return(0,a.jsxs)("div",{className:"app-container",children:[(0,a.jsx)("h1",{className:"title",children:"Integraci\xf3n de Cuentas"}),(0,a.jsx)("p",{className:"subtitle",children:"Procesa y analiza tus archivos Excel de manera eficiente y profesional."}),(0,a.jsx)("div",{className:"glass-card",children:(0,a.jsxs)("div",{className:"form-container",children:[(0,a.jsx)("div",{className:"upload-zone",onClick:()=>{var e;return null===(e=document.getElementById("file-input"))||void 0===e?void 0:e.click()},children:e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s,{className:"w-12 h-12 mx-auto mb-4 text-green-500"}),(0,a.jsx)("p",{className:"text-lg font-medium mb-2",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Haz clic para cambiar el archivo"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i,{className:"w-12 h-12 mx-auto mb-4 text-blue-500"}),(0,a.jsx)("p",{className:"text-lg font-medium mb-2",children:"Arrastra tu archivo Excel aqu\xed"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"o haz clic para seleccionar"})]})}),(0,a.jsx)("input",{id:"file-input",type:"file",accept:".xlsx,.xls",onChange:e=>{var r;return t((null===(r=e.target.files)||void 0===r?void 0:r[0])||null)},className:"hidden"}),(0,a.jsx)("button",{onClick:u,disabled:r||!e,className:"button w-full flex items-center justify-center gap-2",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Procesando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c,{className:"w-5 h-5"}),"Procesar archivo"]})})]})})]})}},622:function(e,t,r){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a=r(2265),l=Symbol.for("react.element"),o=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var a,o={},c=null,d=null;for(a in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)n.call(t,a)&&!s.hasOwnProperty(a)&&(o[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===o[a]&&(o[a]=t[a]);return{$$typeof:l,type:e,key:c,ref:d,props:o,_owner:i.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},7437:function(e,t,r){"use strict";e.exports=r(622)}},function(e){e.O(0,[113,971,864,744],function(){return e(e.s=4455)}),_N_E=e.O()}]);